library("XML")
qb <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=0", stringsAsFactors = FALSE)$playertable_0
rb1 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=2", stringsAsFactors = FALSE)$playertable_0
rb2 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=2&startIndex=40", stringsAsFactors = FALSE)$playertable_0
rb3 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=2&startIndex=80", stringsAsFactors = FALSE)$playertable_0
wr1 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=4", stringsAsFactors = FALSE)$playertable_0
wr2 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=4&startIndex=40", stringsAsFactors = FALSE)$playertable_0
wr3 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=4&startIndex=80", stringsAsFactors = FALSE)$playertable_0
te <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=6", stringsAsFactors = FALSE)$playertable_0
fileList <- c("qb","rb1","rb2","rb3","wr1","wr2","wr3","te")
for(i in 1:length(fileList)){
assign(fileList[i],get(fileList[i])[2:dim(get(fileList[i]))[1],])
t <- get(fileList[i])
names(t) <-  c("rank","player","passCompAtt","passYds","passTds","passInt","rush","rushYds","rushTds","rec","recYds","recTds","pts")
assign(fileList[i], t)
}
rb <- rbind(rb1,rb2,rb3)
wr <- rbind(wr1,wr2,wr3)
qb$pos <- as.factor("QB")
rb$pos <- as.factor("RB")
wr$pos <- as.factor("WR")
te$pos <- as.factor("TE")
projections <- rbind(qb,rb,wr,te)
projections
for(i in 1:length(fileList)){
assign(fileList[i],get(fileList[i])[2:dim(get(fileList[i]))[1],])
t <- get(fileList[i])
names(t) <-  c("positionRank","player","passCompAtt","passYds","passTds","passInt","rush","rushYds","rushTds","rec","recYds","recTds","projectedPts")
assign(fileList[i], t)
}
rb <- rbind(rb1,rb2,rb3)
wr <- rbind(wr1,wr2,wr3)
#Add variable for player position
qb$pos <- as.factor("QB")
rb$pos <- as.factor("RB")
wr$pos <- as.factor("WR")
te$pos <- as.factor("TE")
#Merge players across positions
projections <- rbind(qb,rb,wr,te)
fileList <- c("qb","rb1","rb2","rb3","wr1","wr2","wr3","te")
for(i in 1:length(fileList)){
assign(fileList[i],get(fileList[i])[2:dim(get(fileList[i]))[1],])
t <- get(fileList[i])
names(t) <-  c("positionRank","player","passCompAtt","passYds","passTds","passInt","rush","rushYds","rushTds","rec","recYds","recTds","projectedPts")
assign(fileList[i], t)
}
rb <- rbind(rb1,rb2,rb3)
wr <- rbind(wr1,wr2,wr3)
qb$pos <- as.factor("QB")
rb$pos <- as.factor("RB")
wr$pos <- as.factor("WR")
te$pos <- as.factor("TE")
#Merge players across positions
projections <- rbind(qb,rb,wr,te)
qb
qb <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=0", stringsAsFactors = FALSE)$playertable_0
rb1 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=2", stringsAsFactors = FALSE)$playertable_0
rb2 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=2&startIndex=40", stringsAsFactors = FALSE)$playertable_0
rb3 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=2&startIndex=80", stringsAsFactors = FALSE)$playertable_0
wr1 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=4", stringsAsFactors = FALSE)$playertable_0
wr2 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=4&startIndex=40", stringsAsFactors = FALSE)$playertable_0
wr3 <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=4&startIndex=80", stringsAsFactors = FALSE)$playertable_0
te <- readHTMLTable("http://games.espn.go.com/ffl/tools/projections?&seasonTotals=true&seasonId=2012&slotCategoryId=6", stringsAsFactors = FALSE)$playertable_0
#Add variable names for each object
fileList <- c("qb","rb1","rb2","rb3","wr1","wr2","wr3","te")
for(i in 1:length(fileList)){
assign(fileList[i],get(fileList[i])[2:dim(get(fileList[i]))[1],])
t <- get(fileList[i])
names(t) <-  c("positionRank","player","passCompAtt","passYds","passTds","passInt","rush","rushYds","rushTds","rec","recYds","recTds","projectedPts")
assign(fileList[i], t)
}
rb <- rbind(rb1,rb2,rb3)
wr <- rbind(wr1,wr2,wr3)
#Add variable for player position
qb$pos <- as.factor("QB")
rb$pos <- as.factor("RB")
wr$pos <- as.factor("WR")
te$pos <- as.factor("TE")
projections <- rbind(qb,rb,wr,te)
str(projections)
lapply(projections[,2:3],as.numeric)
lapply(projections[,4:5],as.numeric)
names(projections)
lapply(projections[,c(1,4,5,6,7,8,9,10,11,12,13)],as.numeric)
apply(projections[,c(1,4,5,6,7,8,9,10,11,12,13)],as.numeric)
sapply(projections[,c(1,4,5,6,7,8,9,10,11,12,13)],as.numeric)
?apply
projections <- rbind(qb,rb,wr,te)
#Convert variables from character strings to numeric
projections$passYds <- as.numeric(projections$passYds)
projections$passTds <- as.numeric(projections$passTds)
projections$passInt <- as.numeric(projections$passInt)
projections$rush <- as.numeric(projections$rush)
projections$rushYds <- as.numeric(projections$rushYds)
projections$rushTds <- as.numeric(projections$rushTds)
projections$rec <- as.numeric(projections$rec)
projections$recYds <- as.numeric(projections$recYds)
projections$recTds <- as.numeric(projections$recTds)
projections$pts <- as.numeric(projections$pts)
projections <- rbind(qb,rb,wr,te)
projections
str(projections)
projections$positionRank <- as.numeric(projections$positionRank)
projections$passYds <- as.numeric(projections$passYds)
projections$passTds <- as.numeric(projections$passTds)
projections$passInt <- as.numeric(projections$passInt)
projections$rush <- as.numeric(projections$rush)
projections$rushYds <- as.numeric(projections$rushYds)
projections$rushTds <- as.numeric(projections$rushTds)
projections$rec <- as.numeric(projections$rec)
projections$recYds <- as.numeric(projections$recYds)
projections$recTds <- as.numeric(projections$recTds)
projections$projectedPts <- as.numeric(projections$projectedPts)
str(projections)
?strsplit
projections$passInt <- as.numeric(projections$passInt)
projections
strsplit(projections$passCompAtt, split="\\/")
?str_sub
library("stringr")
?str_sub
str_sub(projections$passCompAtt)
str_sub(projections$passCompAtt, end"/")
str_sub(projections$passCompAtt, end="/")
str_sub(projections$passCompAtt, end="\\/")
str_locate(string=projections$passCompAtt, '/')
str_sub(projections$passCompAtt, end=str_locate(string=projections$passCompAtt, '/')[,1])
str_sub(projections$passCompAtt, end=str_locate(string=projections$passCompAtt, '/')[,1]-1)
projections$passComp <- as.numeric(str_sub(projections$passCompAtt, end=str_locate(string=projections$passCompAtt, '/')[,1]-1))
projections$passComp
as.numeric(str_sub(string=projections$passCompAtt, start=str_locate(string=projections$passCompAtt, '/')[,1]+1))
projections$passAtt <- as.numeric(str_sub(string=projections$passCompAtt, start=str_locate(string=projections$passCompAtt, '/')[,1]+1))
projections[,c("passCompAtt","passComp","passAtt")]
projections <- rbind(qb,rb,wr,te)
projections$passComp <- as.numeric(str_sub(string=projections$passCompAtt, end=str_locate(string=projections$passCompAtt, '/')[,1]-1))
projections$passAtt <- as.numeric(str_sub(string=projections$passCompAtt, start=str_locate(string=projections$passCompAtt, '/')[,1]+1))
projections$positionRank <- as.numeric(projections$positionRank)
projections$passYds <- as.numeric(projections$passYds)
projections$passTds <- as.numeric(projections$passTds)
projections$passInt <- as.numeric(projections$passInt)
projections$rush <- as.numeric(projections$rush)
projections$rushYds <- as.numeric(projections$rushYds)
projections$rushTds <- as.numeric(projections$rushTds)
projections$rec <- as.numeric(projections$rec)
projections$recYds <- as.numeric(projections$recYds)
projections$recTds <- as.numeric(projections$recTds)
projections$projectedPts <- as.numeric(projections$projectedPts)
projections
projections$name <- str_sub(projections$player,end = str_locate(string=projections$player, ',')[,1]-1) #unlist(strsplit(projections$player, ","))[seq(1,length(unlist(strsplit(projections$player, ","))),by=2)]
projections$name <- str_replace_all(projections$name, "\\*", "") #projections$name <- str_replace_all(projections$name, "[[:punct:]]", "")
projections[which(projections$name=="Steve Johnson"),"name"] <- "Stevie Johnson"
projections
projections$overallRank <- rank(-projections$projectedPts, ties.method="min")
projections
str_locate(string=projections$player, ',')[,1]+1
str_sub(projections$player, start=str_locate(string=projections$player, ',')[,1]+1)
str_sub(projections$player, start=str_locate(string=projections$player, ',')[,1]+2)
str_sub(projections$player, start=str_locate(string=projections$player, ',')[,1]+2, end = str_locate(string=projections$player, ',')[,1]+5)
str_sub(projections$player, start=str_locate(string=projections$player, ',')[,1]+2, end = str_locate(string=projections$player, ',')[,1]+4)
str_replace_all(projections$name, " ", "")
str_replace_all(projections$team, " ", "")
projections$team <- str_sub(projections$player, start=str_locate(string=projections$player, ',')[,1]+2, end = str_locate(string=projections$player, ',')[,1]+4)
str_replace_all(projections$team, " ", "")
str_replace_all(projections$team, "[[:punct:]]", "")
?str_trim
str_trim(projections$team, side="right")
projections$team <- str_trim(projections$team, side="right")
projections <- rbind(qb,rb,wr,te)
#Separate pass completions from attempts
projections$passComp <- as.numeric(str_sub(string=projections$passCompAtt, end=str_locate(string=projections$passCompAtt, '/')[,1]-1))
projections$passAtt <- as.numeric(str_sub(string=projections$passCompAtt, start=str_locate(string=projections$passCompAtt, '/')[,1]+1))
#Convert variables from character strings to numeric
projections$positionRank <- as.numeric(projections$positionRank)
projections$passYds <- as.numeric(projections$passYds)
projections$passTds <- as.numeric(projections$passTds)
projections$passInt <- as.numeric(projections$passInt)
projections$rush <- as.numeric(projections$rush)
projections$rushYds <- as.numeric(projections$rushYds)
projections$rushTds <- as.numeric(projections$rushTds)
projections$rec <- as.numeric(projections$rec)
projections$recYds <- as.numeric(projections$recYds)
projections$recTds <- as.numeric(projections$recTds)
projections$projectedPts <- as.numeric(projections$projectedPts)
#Player names
projections$name <- str_sub(projections$player, end=str_locate(string=projections$player, ',')[,1]-1) #unlist(strsplit(projections$player, ","))[seq(1,length(unlist(strsplit(projections$player, ","))),by=2)]
projections$name <- str_replace_all(projections$name, "\\*", "") #projections$name <- str_replace_all(projections$name, "[[:punct:]]", "")
projections[which(projections$name=="Steve Johnson"),"name"] <- "Stevie Johnson"
#Player teams
projections$team <- str_sub(projections$player, start=str_locate(string=projections$player, ',')[,1]+2, end = str_locate(string=projections$player, ',')[,1]+4)
projections$team <- str_trim(projections$team, side="right")
projections
projections$overallRank <- rank(-projections$projectedPts, ties.method="min")
projections
projections[,c("name","pos","team","positionRank","overallRank","passAtt","passComp","passYds","passTds","passInt","rushYds","rushTds","recYds","recTds","projectedPts")]
projections[order(projections$overallRank),]
projections <- projections[order(projections$overallRank),]
projections
projections <- projections[,c("name","pos","team","positionRank","overallRank","passAtt","passComp","passYds","passTds","passInt","rushYds","rushTds","recYds","recTds","projectedPts")]
#Order players by overall rank
projections <- projections[order(projections$overallRank),]
projections
row.names(projections) <- 1:max(as.numeric(row.names(projections)))
max(as.numeric(row.names(projections)))
projections
dim(projections)
row.names(projections) <- 1:dim(projections)[1]
projections
source('~/GitHub/FantasyFootballAnalyticsR/ESPN Projections.R', echo=TRUE)
projections
